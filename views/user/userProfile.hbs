<style>
  .Password {
    text-decoration: none;
    !important
  }
</style>

<head>
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>


<section style="background-color: #eee;">
  <div class="container py-5">
    <div class="row">
      <div class="col">
        <nav aria-label="breadcrumb" class="bg-light rounded-3 p-3 mb-4">
          <ol class="breadcrumb mb-0">
            <li class="breadcrumb-item"><a href="/">Home</a></li>
            <li class="breadcrumb-item active" aria-current="page">UserProfile</li>
          </ol>
        </nav>
      </div>
    </div>

    <div class="row">
      <div class="col-lg-4">
        <div class="card mb-4">
          <div class="card-body text-center">
            <img
              src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRkiIFjCOZ-mMeqxd2ryrneiHedE8G9S0AboA&usqp=CAU"
              alt=" " style="height:7rem;" > 
            <h5 class="my-3">{{currentUser.name}}</h5>
            <p class="text-muted mb-1">{{currentUser.email}}</p>
            <p class="text-muted mb-4">Bay Area, San Francisco, CA</p>
            <div class="d-flex justify-content-center mb-2">
              <a href="" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">Edit</a> <br>
            </div>
            <a href="" class="Password" data-bs-toggle="modal" data-bs-target="#passwordChange">Change Password</a>
          </div>
        </div>
        <div class="card mb-4 mb-lg-0">

        </div>
      </div>
      <div class="col-lg-8">

        <div class="card mb-4">
          <div class="card-body">
            <div class="row">
              <div class="col-sm-3">
                <p class="mb-0">Name:</p>
              </div>
              <div class="col-sm-9">
                <p class="text-muted mb-0">{{currentUser.name}}</p>
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3">
                <p class="mb-0">Email:</p>
              </div>
              <div class="col-sm-9">
                <p class="text-muted mb-0">{{currentUser.email}}</p>
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3">
                <p class="mb-0">Phone:</p>
              </div>
              <div class="col-sm-9">
                <p class="text-muted mb-0">{{currentUser.number}}</p>
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3">
                <p class="mb-0">Address:</p>
              </div>
              <div class="col-sm-9">
                <p class="text-muted mb-0"> {{currentUser.Address.[0]}}</p>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>
</section>


<!-- Edit Modal  -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="container">

        <form id="form">
          <div class="form-group">
            <label for="recipient-name" class="col-form-label">Name:</label>
            <input type="text" class="form-control" id="recipient-name" name="name" value={{currentUser.name}}>
          </div>
          <div class="form-group">
            <label for="recipient-name" class="col-form-label">Email:</label>
            <input type="text" class="form-control" id="recipient-name" name="email" value={{currentUser.email}}>
          </div>
          <div class="form-group">
            <label for="recipient-name" class="col-form-label">Phone:</label>
            <input type="text" class="form-control" id="recipient-name" name="number" value={{currentUser.number}}>
          </div>
          <div class="form-group">
            <label for="message-text" class="col-form-label">Address:</label>
            <textarea class="form-control" id="message-text" name="Address"> {{currentUser.Address.[0]}}</textarea>
          </div>
          <p id="errorId" class="text-danger"></p>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="submit" class="btn btn-primary">Save changes</button>
          </div>
        </form>

      </div>
    </div>
  </div>
</div>



{{!-- Change Password Modal --}}


<!-- Password Modal  -->
<div class="modal fade" id="passwordChange" tabindex="-1" aria-labelledby="passwordModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="container">

        <form id="passwordForm">
          <div class="form-group">
            <label for="recipient-name" class="col-form-label">Enter Current Password:</label>
            <input type="text" class="form-control" id="recipient-name" name="currentPassword" required
              placeholder="Current Password">
          </div>
          <div class="form-group">
            <label for="recipient-name" class="col-form-label">Enter New Password:</label>
            <input type="text" class="form-control" id="recipient-name" name="newPassword" required
              placeholder="New Password">
          </div>

          <p id="passwordErrorId" class="text-danger"></p>

          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="submit" class="btn btn-primary">Save changes</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
  integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
  integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>

<script>

  //     ---------  Edt Modal  -------


  const form = document.getElementById("form")
  form.addEventListener('submit', async (e) => {
    e.preventDefault()
    const data = new FormData(form)
    const formData = {}
    data.forEach((data, i) => {
      formData[i] = data
    })
    const res = await axios.post('/userProfile', formData)
    if (res.data.message == "success") {

      Toastify({
        text: "Succesfully Updated",
        duration: 3000,
        gravity: "bottom",
        position: "center",
        style: {
          background: '#0E86D4',

        },
      }).showToast();


      setTimeout(() => {
        location.assign("/userProfile")
      }, 2000)


    } else {
      document.getElementById("errorId").textContent = res.data.error
    }

  })



  // Password Modal

  const pForm = document.getElementById("passwordForm")
  pForm.addEventListener('submit', async (e) => {
    e.preventDefault()
    const data = new FormData(pForm)
    const formData = {}
    data.forEach((data, i) => {
      formData[i] = data
    })
    const res = await axios.patch('/userProfile', formData)
    if (res.data.message == "success") {

      Toastify({
        text: "Succesfully Updated",
        duration: 3000,
        gravity: "bottom",
        position: "center",
        style: {
          background: '#0E86D4',

        },
      }).showToast();


      setTimeout(() => {
        location.assign("/userProfile")
      }, 2000)


    } else {
      document.getElementById("passwordErrorId").textContent = res.data.error
    }

  })



</script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>